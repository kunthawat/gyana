{% extends "web/app/project_base.html" %}
{% load static %}
{% block app %}
<div class="workflow-detail__header">
  <form method="post" action="{% url 'projects:dashboards:detail' project.id object.id %}" class="form mr-auto">
    {% csrf_token %}

    <input class='input__inline' id="name" type="text" name="name" value="{{ object.name }}"></input>

  </form>

  <div data-controller='popover'>
    <button 
      data-popover-target="trigger" 
      class="button button--square button--filled button--sm"
      data-action="popover#trigger"
    >
      Add widget <i class="fas fa-angle-up fa-rotate-180"></i>
    </button>

    <ul data-popover-target="body" class="list list--bordered" style="display:none;z-index:1;margin-top:6px;">
      {% for id, txt, icon in choices %}
      <li class="list__item list__item--interactive" data-id="{{id}}">
        <form method="post" action="{% url 'projects:dashboards:widgets:create' project.id dashboard.id %}" class="form">
          {% csrf_token %}
          <input type='hidden' name='kind' id='id_kind' value="{{id}}" />
          <button type="submit"><p><i class="fas {{icon}} text-blue mr-2"></i> {{txt}}</p></button>
        </form>
      </li>
      {% endfor %}
    </ul>
  </div>
  <a class="button button--circle button--tertiary" href="{% url 'projects:dashboards:delete' project.id object.pk %}">
    <i class="far fa-fw fa-trash"></i>
  </a>
</div>

<div class="p-4 pb-0 overflow-auto w-full h-full">
  <turbo-frame id="widgets" src="{% url 'projects:dashboards:widgets:list' project.id object.id %}" target="_top">
  </turbo-frame>
</div>
{% endblock %}

{% block page_js %}
<script src="{% static 'js/templates-bundle.js' %}"></script>
<script src="{% static "fusioncharts/fusioncharts.js" %}"></script>
<script src="{% static "fusioncharts/fusioncharts.charts.js" %}"></script>
<script src="{% static "fusioncharts/themes/fusioncharts.theme.fusion.js" %}"></script>
{% endblock %}
